{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"What's Edge Thoughts?","text":"<p>These are my thoughts and notes about all things, but not limited to, defensive cyber security, threat hunting and digital forensics. Basically I needed a place to dump my brain contents where I come and retrieve it at a later date. </p>"},{"location":"#purpose","title":"Purpose","text":"<p>The goal of this site is simple. Read clever researcher's work, the latest cyber threat intelligence or various documentation give it a go, then document the results. I'm hoping to document various aspects of defensive cyber security such as:</p> <ul> <li>Using powershell, cmd and bash for investigations.</li> <li>How-to perform forensic analysis on memory, disk, filesystem, etc.</li> <li>Learning more about windows and linux system internals. </li> <li>See what forensic artifacts TTPs leave behind on a system.</li> <li>Guides on how to use various industry tools. </li> </ul> <p>Info</p> <ul> <li>Do not expect my notes to be comprehensive.</li> <li>Expect mistakes. I make them! You will too!</li> <li>Consult additional resources if it doesn't work the way you want.</li> </ul> <p>Warning</p> <p>This notebook is created by David M Reiling. Copying it, cloning it or using some janky AI tool to re-present it is your own is NOT OK (and probably illegal). </p>"},{"location":"Digital%20Forensics/Memory/","title":"Memory Forensics","text":""},{"location":"Digital%20Forensics/Memory/#background","title":"Background","text":"<p>Memory is valuable forensic artifact which can hold running processes, network connections, loaded executables, logged in users, recent commands, injected code, encryption keys, passwords and more. Memory forensics are essential for detecting fileless malware, which is malware which exists only as in memory, operating without an executable and leaving minimal footprint on disk. </p> <p>Random Access Memory (RAM) is usually the focus of memory acquisition. RAM is divided into two areas:</p> <ul> <li>Kernel Space: Operating system and low-level services, i.e. device drivers.</li> <li>User Space: Processes launched by the user or applications. </li> </ul> <p>User space processes are particularly crucial. This memory contains the following areas:</p> <ul> <li>Stack: Stores emporary data such as function arguments and return addresses. It expands and contracts as functions are called and returned.</li> <li>Heap: Used for dynamic memory allocation during runtime, such as objects.</li> <li>Executable: Holds code or instructions the CPU executes.</li> <li>Data sections: Stores global variables and data the executable requires.</li> </ul> <p>Types of memory dumps generally include:</p> <ul> <li>Full: Captures all RAM, including user and kernel space.</li> <li>Process Dump: Captures the memory of a singular process.</li> <li>Pagefile / Swap Analysis: Systems offload some memory content to disk when RAM is full. On Windows, this is stored in pagefile.sys, and on Linux, in a swapfile. These files can be analysed further. </li> </ul> <p>Windows contains some memory artifacts which can be acquired if the system has been put to sleep or powered off. </p> <ul> <li><code>%SystemDrive%\\hiberfil.sys</code> Created when a computer has been put to sleep.</li> <li><code>%SystemRoot%\\pagefile.sys</code> Contains infrequently accessed memory objects from RAM; stored physically in this file.</li> <li><code>%SystemRoot%\\MEMORY</code> Default location where memory dumps are stored after system failures, i.e. BSOD. </li> </ul>"},{"location":"Digital%20Forensics/Memory/#acquisition","title":"Acquisition","text":"<p>Dues to its volatile nature, memory is often the first evidence acquired in a forensics investigation. Tools used to acquire memory include:</p> Tool Description Link Magnet Dumpot Windows memory acquisition tool https://www.magnetforensics.com/resources/magnet-dumpit-for-windows/ WinPmem Lightweight windows memory acquisition executable. https://winpmem.velocidex.com/ procdump sysinternals utility for dumping the memory of a given process. https://learn.microsoft.com/en-us/sysinternals/downloads/procdump FTK Imager Row 1, Col 2 https://www.exterro.com/digital-forensics-software/ftk-imager LiME Classic linux memory acquisition tool. No longer supported. https://github.com/504ensicsLabs/LiME dd Built in linux utility. Requires sudo priveleges to install the fmem kernel module https://www.levelblue.com/blogs/levelblue-blog/volatile-data-acquisition-on-linux-systems-using-fmem"},{"location":"Digital%20Forensics/Memory/#evasion","title":"Evasion","text":"<p>Attackers will often use anti-forensic techniques to hid their presence in memory and make reverse engineering their tools challenging. These examples include:</p> Tool Description Unlinked &amp; hidden modules Malware will unlink itself from process lists. This hides it from system tools. DKOM (Direct Kernel Object Manipulation) This technique alters kernel structures to hide processes, threads, or drivers from system tools. Code injection Malicious code is injected into legitimate processes (i.e. notepad.exe) to evade detection. Memory patching Malware modifies memory or system APIs at runtime for defense evasion. Hooking APIs or system calls Intercepts and alters the output of critical system functions. Encrypted payloads Payloads are kept encrypted until execution time, making static analysis difficult. Trigger-based payloads The in-memory malware only unpacks or runs when specific conditions are met, evading defenses during a normal inspection"},{"location":"Digital%20Forensics/Memory/#memory-analysis","title":"Memory Analysis","text":""},{"location":"Digital%20Forensics/Memory/#volatility","title":"Volatility","text":"<p>Volatiltiy is a memory analysis program written in python. This is an industry standard tool for memory analysis. </p> <p>Here are some cheat sheet commands below. Note: these commands apply to version 3 only. Version 2 was deprecated in May 2025.</p> Command Description <code>python3 vol.py -h</code> volatility help menu <code>python3 vol.py -f \"&lt;filepath&gt;\" windows.info</code> Retrieves memory profile /symbols from a windows memory dump <code>python3 vol.py -f \"&lt;filepath&gt;\" windows.plist</code> Retrieves windows processes <code>python3 vol.py -f \"&lt;filepath&gt;\" windows.pstree</code> Lists windows processes in tree view <code>python3 vol.py -f \"&lt;filepath&gt;\" windows.pstree</code> Scans windows processes <code>python3 vol.py -f \"&lt;filepath&gt;\" windows.cmdline</code> Lists windows commandlines <code>python3 vol.py -f \"&lt;filepath&gt;\" windows.handles --pid &lt;PID&gt;</code> Lists file handles for a given process"},{"location":"Digital%20Forensics/Windows/","title":"Windows","text":"<p>This section contains general guides on how to profile a windows system during an invesigation using only the available tools, i.e. powerhshell and the command prompt.  </p> <p>Many of these commands will use powershell to query Common Information Model (CIM) instances. CIM is a cross-platform standard for managing system data. The standard is maintained by https://www.dmtf.org/standards/cim. The equivalent powershell or cmd commands can also be used. </p>"},{"location":"Digital%20Forensics/Windows/#system-profiling","title":"System Profiling","text":"<p>The first step is to profile the system. This includes gathering basic system information such as hostname, network adapters, operating system and time zone. </p> <p>List the data and timezone. <pre><code>Get-Date ; Get-TimeZone\n</code></pre></p> <p>Retrieve the configuration for enabled network adapters <pre><code>Get-CimInstance win32_networkadapterconfiguration -Filter IPEnabled=TRUE | ft DNSHostname, IPAddress, MACAddress\n</code></pre></p> <p>Retrieve the operating system details including the last boot time. <pre><code>Get-CimInstance -ClassName Win32_OperatingSystem | fl CSName, Version, BuildNumber, InstallDate, LastBootUpTime, OSArchitecture\n</code></pre></p> <p>List all the drives connected to the system <pre><code>Get-CimInstance -ClassName Win32_Volume | Select-Object -Property DriveLetter, Label, FileSystem, Capacity, FreeSpace\n</code></pre></p>"},{"location":"Digital%20Forensics/Windows/#users-groups","title":"Users / Groups","text":"<p>Threat actors can create new accounts or manipulate existing accounts. The following are some basic commands to profile the users on a windows system.</p> <p>Retrieve all logged on users. <pre><code>Get-CimInstance -ClassName Win32_LoggedOnUser | Select-Object -Property Dependent, Antecedent\n</code></pre></p> <p>Retrieve all user accounts. <pre><code>Get-CimInstance -ClassName Win32_UserAccount | Select-Object -Property Name, Caption, AccountType, SID, SIDType, InstallDate, Domain, LocalAccount, Disabled, Description, PasswordRequired\n</code></pre></p> <p>Retrieve all user accounts and their group membership. <pre><code>Get-CimInstance -ClassName Win32_GroupUser | Select-Object -Property @{Name='Group'; Expr={$_.GroupComponent.Name}}, @{Name='Users'; Expr={$_.PartComponent.Name}}\n</code></pre></p>"},{"location":"Digital%20Forensics/Windows/#network-activity","title":"Network Activity","text":"<p>These commands look at the network activity and configuration of a system. </p> <p>List all the nework connections and correlate them to their processes.  <pre><code>Get-NetTCPConnection | Select-Object -Property Local*, Remote*, State, OwningProcess,` @{n=\"ProcName\";e={(Get-Process -Id $_.OwningProcess).ProcessName}},` @{n=\"ProcPath\";e={(Get-Process -Id $_.OwningProcess).Path}} `\n</code></pre></p> <p>List all mounted Network Shares. See also: Net view. <pre><code>Get-CimInstance -Class Win32_Share | Select-Object -Property Name, Path, Description \n</code></pre></p> <p>List all the configured DNS Servers on a host. <pre><code>Get-CimInstance Win32_NetworkAdapterConfiguration -Filter \"IPEnabled = True\" | Select-Object Description, DNSServerSearchOrder\n</code></pre></p> <p>Dump the existing DNS Cache. <pre><code>Get-DnsClientCache | Select-Object -Property Entry, Type, Data, TimeToLive\n</code></pre></p> <p>Read the DNS hosts file <pre><code>Get-Content \"C:\\Windows\\System32\\drivers\\etc\\hosts\"\n</code></pre></p>"},{"location":"Digital%20Forensics/Windows/#startup","title":"Startup","text":"<p>"},{"location":"Digital%20Forensics/Windows/#registry","title":"Registry","text":"<p>"},{"location":"Digital%20Forensics/Windows/#services","title":"Services","text":"<p>"},{"location":"Digital%20Forensics/Windows/#scheduled-tasks","title":"Scheduled Tasks","text":"<p>"},{"location":"Tools/Command%20Prompt/","title":"Command Prompt","text":"<p>This section contains some of my favorite windows command prompt tools along with snippets of my favorite commands. </p>"},{"location":"Tools/Command%20Prompt/#pktmon","title":"Pktmon","text":"<p>Pktmon or Packet Monitor \"is an in-box, cross-component network diagnostics tool for Windows. It can be used for packet capture...\" Most people do not seem to know that since Windows 10/Windows 2016 there is a built-in utility to perform packet captures on a Windows Host. Previously you would need wireshark or another application. I still reccommend analyzing the traffic in wireshark.</p> <p>For reference: https://learn.microsoft.com/en-us/windows-server/networking/technologies/pktmon/pktmon</p>"},{"location":"Tools/Command%20Prompt/#cheat-sheet","title":"Cheat Sheet","text":"Command Description <code>pktmon filter add help</code> Open the help menu for adding filters <code>pktmon filter add &lt;blah&gt;</code> Create a pktmon filter <code>pktmon filter list</code> List a pktmon filter <code>pktmon filter list</code> Remove all filters <code>pktmon start -c</code> Start capturing packets <code>pktmon start --etw -m real-time</code> Capture packets in real-time on the screen <code>pktmon stop</code> Stop capturing packets <code>pktmon etl2txt &lt;etl file path&gt;</code> Convert and export an etl file to text <code>pktmon etl2pcap .\\PktMon.etl --out Pktmon.pcapng</code> Convert and export to a pcapng file <code>pktmon counters</code> List packet counters as a packet capture is occurring <code>pktmon list</code> List all components/interfaces which can capture packets <code>pktmon status</code> List current packet capture status"},{"location":"Tools/Command%20Prompt/#example-1","title":"Example 1","text":"<p>Capture all traffic. Convert the default .etl (Event Trace Log) format to a pcapng file. <pre><code>pktmon start -c\npktmon stop\npktmon etl2pcap .\\PktMon.etl --out Pktmon.pcapng\n</code></pre></p>"},{"location":"Tools/Command%20Prompt/#example-2","title":"Example 2","text":"<p>Create a filter to capture web and DNS traffic. <pre><code>pktmon filter add HTTP -p 80\npktmon filter add HTTPS -p 80\npktmon filter add DNS -t UDP -p 53\npktmon start -c\npktmon stop\npktmon etl2pcap .\\PktMon.etl --out Pktmon.pcapng\n</code></pre></p>"},{"location":"Tools/Command%20Prompt/#example-3","title":"Example 3","text":"<p>Run a test for one minute by pinging 8.8.8.8  <pre><code>$pktmonTime = (Get-Date).AddMinutes(1)\nwhile ((Get-Date) -le $pktmonTime) {\n    ping 8.8.8.8\n    Start-Sleep -Seconds 10\n}\n</code></pre> Create a filter to capture ICMP traffic to 8.8.8.8. <pre><code>pktmon filter add -i 8.8.8.8 -t ICMP\npktmon start --etw -m real-time\n</code></pre></p>"},{"location":"Tools/Command%20Prompt/#net","title":"net","text":"<p>The net command has several uses. Here are a few! </p>"},{"location":"Tools/Command%20Prompt/#cheat-sheet_1","title":"Cheat Sheet","text":"Command Description <code>net localgroup administrators</code> List of every group with an admin account <code>net start</code> See every service running on a system <code>net user &lt;username&gt;</code> View a given user information <code>net use</code> Lists all mapped network shares <code>net view \\\\&lt;computer or ip address&gt;</code> Lists all shares on a remote host <code>net view /domain:&lt;blah&gt;</code> Lists all systems registered with a given domain <code>net user /domain</code> Lists all users for a given domain"},{"location":"Tools/Command%20Prompt/#net-view","title":"net view","text":"<p>The net <code>net view</code> command for enumerating shares on a remote system.  This can be used by both a threat actor for File and Directory Discovery. From a defensive perspective it can be useful to monitor for these commands or to discover file shares to understand where a threat actor may have moved laterally. </p> <p>Enumerate shares on a remote system. <pre><code>net view \\\\&lt;computer or ip address&gt;\n</code></pre></p> <p>Collect shared folder names in an array and print to console. <pre><code>$sharedFolders = (NET.EXE VIEW \\\\&lt;computer or ip address&gt;) \n$sharedFolders[7].split('  ')[0]\n</code></pre></p> <p>Print folder names to the console. <pre><code>(net view \\\\&lt;computer or ip address&gt;) | % { if($_.IndexOf(' Disk ') -gt 0){ $_.Split('  ')[0] } }\n</code></pre></p>"},{"location":"ztest/admonitions/","title":"Admonitions","text":"<p>Title of the callout</p> <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod nulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor massa, nec semper lorem quam in massa.</p> <p>Collapsible callout:</p> Collapsible callout <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod nulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor massa, nec semper lorem quam in massa.</p>"},{"location":"ztest/code-examples/","title":"Code examples","text":"<p>Python code example add_num.py<pre><code># Function to add two numbers\ndef add_two_numbers(num1, num2):\n\nreturn num1 + num2\n</code></pre> Powershell sample powershell_test.ps1<pre><code>Write-Host \"Hello from PowerShell\"\n$var = Get-Service\nWrite-Host \"Hello, MkDocs!\"\nGet-Service -Name \"Spooler\"\n</code></pre></p> <p>bash sample smash.sh<pre><code>#!/bin/bash\necho \"Hello from Bash\"\nexport VAR=\"value\"\n</code></pre></p> <p>cmd.exe sample command.bat<pre><code>@echo off\necho Hello from CMD\nset VAR=value\n</code></pre></p> <p>Splunk example <pre><code>index=main sourcetype=access_combined\n| stats count by categoryId\n| eval description=\"Total Events\"\n| table description, count\n</code></pre></p>"}]}